{% extends "base.html" %}

{% block content %}
<script src="{{ url_for('static', filename='echarts.min.js') }}"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

<style>
    /* === é¡µé¢ä¸“å±æ ·å¼ === */
    :root {
        --sgcc-dark: #006938;
        --sgcc-light: #e9f5ef;
        --text-gray: #666;
        --border-color: #e0e0e0;
    }

    /* é¡¶éƒ¨é¢åŒ…å±‘ç¾åŒ– */
    .breadcrumb-wrap {
        background: white;
        padding: 15px 30px;
        font-size: 14px;
        color: var(--text-gray);
        border-bottom: 1px solid var(--border-color);
        margin-bottom: 20px;
        box-shadow: 0 2px 4px rgba(0,0,0,0.02);
    }
    .breadcrumb-wrap span { margin: 0 8px; color: #ddd; }
    .breadcrumb-wrap a { color: #666; text-decoration: none; transition: color 0.2s; }
    .breadcrumb-wrap a:hover { color: var(--sgcc-dark); }

    /* ä¸»å®¹å™¨ */
    .eval-container {
        max-width: 1000px;
        margin: 0 auto 50px auto;
        padding: 0 20px;
    }

    /* åŠŸèƒ½å¤´éƒ¨å¡ç‰‡ */
    .feature-header-card {
        background: white;
        border-radius: 12px;
        padding: 30px;
        box-shadow: 0 5px 20px rgba(0,0,0,0.05);
        display: flex;
        justify-content: space-between;
        align-items: center;
        border-left: 6px solid var(--sgcc-dark);
        margin-bottom: 25px;
    }
    .header-content h1 { margin: 0 0 10px 0; font-size: 24px; color: #333; }
    .header-content p { margin: 0; color: #888; font-size: 14px; }
    
    /* å¤´éƒ¨å³ä¾§åŒºåŸŸï¼ˆè¿”å›æŒ‰é’®+å›¾æ ‡ï¼‰ */
    .header-right { display: flex; align-items: center; gap: 20px; }
    .header-icon { font-size: 40px; color: var(--sgcc-dark); opacity: 0.1; }
    
    /* ã€æ–°å¢ã€‘æ˜¾çœ¼çš„è¿”å›æŒ‰é’® */
    .btn-back-header {
        display: flex;
        align-items: center;
        gap: 8px;
        padding: 8px 16px;
        background-color: #f8f9fa;
        color: #555;
        border: 1px solid #ddd;
        border-radius: 20px;
        text-decoration: none;
        font-size: 14px;
        font-weight: 500;
        transition: all 0.2s;
    }
    .btn-back-header:hover {
        background-color: var(--sgcc-dark);
        color: white;
        border-color: var(--sgcc-dark);
        transform: translateX(-3px); /* æ‚¬åœæ—¶å¾®å¾®å‘å·¦åŠ¨ */
    }

    /* === æ ¸å¿ƒä¸Šä¼ åŒº (Drag & Drop) === */
    .upload-card {
        background: white;
        border-radius: 12px;
        box-shadow: 0 5px 20px rgba(0,0,0,0.05);
        padding: 40px;
        text-align: center;
        transition: all 0.3s;
    }

    .upload-zone {
        border: 2px dashed #ccc;
        border-radius: 10px;
        padding: 40px 20px;
        background: #fafafa;
        cursor: pointer;
        transition: all 0.3s ease;
        position: relative;
    }

    .upload-zone:hover, .upload-zone.dragover {
        border-color: var(--sgcc-dark);
        background: var(--sgcc-light);
        transform: scale(1.01);
    }

    .upload-icon {
        font-size: 48px;
        color: #999;
        margin-bottom: 15px;
        transition: color 0.3s;
    }
    .upload-zone:hover .upload-icon { color: var(--sgcc-dark); }

    .upload-text h3 { margin: 10px 0; color: #333; }
    .upload-text p { color: #999; font-size: 13px; }
    
    /* æ–‡ä»¶é€‰ä¸­åçš„çŠ¶æ€ */
    .file-preview {
        display: none;
        margin-top: 20px;
        background: var(--sgcc-light);
        padding: 15px;
        border-radius: 8px;
        color: var(--sgcc-dark);
        font-weight: bold;
        align-items: center;
        justify-content: center;
        gap: 10px;
        animation: fadeIn 0.5s;
    }
    
    @keyframes fadeIn { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }

    /* æäº¤æŒ‰é’® */
    .action-area { margin-top: 30px; display: flex; flex-direction: column; align-items: center; gap: 15px; }
    .btn-submit {
        background: linear-gradient(135deg, var(--sgcc-dark) 0%, #008a4e 100%);
        color: white;
        border: none;
        padding: 12px 40px;
        font-size: 16px;
        border-radius: 30px;
        cursor: pointer;
        box-shadow: 0 4px 15px rgba(0, 105, 56, 0.3);
        transition: transform 0.2s, box-shadow 0.2s;
        font-weight: bold;
        letter-spacing: 1px;
    }
    .btn-submit:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(0, 105, 56, 0.4); }
    .btn-submit:disabled { background: #ccc; cursor: not-allowed; box-shadow: none; transform: none; }

    .link-cancel { color: #999; text-decoration: none; font-size: 14px; transition: color 0.2s; }
    .link-cancel:hover { color: #666; text-decoration: underline; }

    /* === è¿›åº¦ä¸çŠ¶æ€åŒº === */
    .process-status {
        display: none;
        margin-top: 30px;
        text-align: left;
    }
    
    .status-steps {
        display: flex;
        justify-content: space-between;
        margin-bottom: 15px;
        position: relative;
    }
    /* è¿çº¿ */
    .status-steps::before {
        content: ''; position: absolute; top: 14px; left: 0; width: 100%; height: 2px; background: #eee; z-index: 0;
    }
    
    .step-item {
        position: relative; z-index: 1; background: white; padding: 0 10px; text-align: center; color: #999;
    }
    .step-circle {
        width: 30px; height: 30px; background: #eee; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 5px; font-weight: bold; color: white; transition: all 0.3s;
    }
    .step-item.active .step-circle { background: var(--sgcc-dark); box-shadow: 0 0 0 4px var(--sgcc-light); }
    .step-item.active { color: var(--sgcc-dark); font-weight: bold; }

    /* è¿›åº¦æ¡åŠ¨ç”» */
    .progress-track {
        height: 8px; background: #eee; border-radius: 4px; overflow: hidden; margin-top: 20px;
    }
    .progress-bar-fill {
        height: 100%; width: 0%; background: var(--sgcc-dark);
        background-image: linear-gradient(45deg,rgba(255,255,255,.15) 25%,transparent 25%,transparent 50%,rgba(255,255,255,.15) 50%,rgba(255,255,255,.15) 75%,transparent 75%,transparent);
        background-size: 1rem 1rem;
        transition: width 0.3s ease;
    }

    /* === ç»“æœå¡ç‰‡æ ·å¼ === */
    .result-container { margin-top: 30px; animation: slideUp 0.6s ease-out; }
    @keyframes slideUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
    
    .result-card {
        background: white; border-radius: 12px; box-shadow: 0 5px 25px rgba(0,0,0,0.08); overflow: hidden; border: 1px solid rgba(0,0,0,0.05);
    }
    .result-header { padding: 25px 30px; border-bottom: 1px solid #f0f0f0; display: flex; justify-content: space-between; align-items: center; background: #fdfdfd; }
    .result-body { padding: 30px; }
    
    /* è¡¨æ ¼ç¾åŒ– */
    .sgcc-table { width: 100%; border-collapse: collapse; margin-top: 20px; font-size: 14px; box-shadow: 0 0 0 1px #eee; border-radius: 8px; overflow: hidden; }
    .sgcc-table th { background: #f7f9fa; padding: 15px; color: #444; font-weight: 600; text-align: left; }
    .sgcc-table td { padding: 15px; border-top: 1px solid #eee; color: #666; }
    .sgcc-table tr:hover { background: #f0fcf6; }

    .badge { display: inline-block; padding: 4px 10px; border-radius: 20px; font-size: 12px; font-weight: bold; }
    .badge-red { background: #fde8e8; color: #c81e1e; }
    .badge-yellow { background: #fdf6b2; color: #8e4b10; }
    .badge-blue { background: #e1effe; color: #1a56db; }

    .score-val { font-size: 42px; font-weight: 800; }
</style>

<div class="breadcrumb-wrap">
    <a href="{{ url_for('index') }}">é¦–é¡µ</a> <span>/</span> 
    <a href="{{ url_for('level2_view', level1_name=l1) }}">{{ l1 }}</a> <span>/</span> 
    <a href="{{ url_for('level3_view', level1_name=l1, level2_name=l2) }}">{{ l2 }}</a> <span>/</span> 
    <strong>{{ feature_name }}</strong>
</div>

<div class="eval-container">
    
    <div class="feature-header-card">
        <div class="header-content">
            <h1>{{ feature_name }}</h1>
            <p>åŸºäºå…‰æ˜å¤§æ¨¡å‹ (Qwen-Plus) çš„æ™ºèƒ½è¯„å®¡å¼•æ“ï¼Œæ”¯æŒå¤šæ¨¡æ€æ–‡æ¡£è§£æä¸æ·±åº¦é€»è¾‘æ ¡éªŒã€‚</p>
        </div>
        <div class="header-right">
            <a href="{{ url_for('level3_view', level1_name=l1, level2_name=l2) }}" class="btn-back-header">
                <i class="fas fa-arrow-left"></i> è¿”å›ä¸Šä¸€çº§
            </a>
            <div class="header-icon">
                <i class="fas fa-brain"></i>
            </div>
        </div>
    </div>

    <div class="upload-card">
        <form id="uploadForm" action="{{ url_for('eval_5_1.process', level1=l1, level2=l2, feature_name=feature_name) }}" method="post" enctype="multipart/form-data">
            
            <div class="upload-zone" id="dropZone" onclick="document.getElementById('file').click()">
                <div class="upload-icon"><i class="fas fa-cloud-upload-alt"></i></div>
                <div class="upload-text">
                    <h3>ç‚¹å‡»é€‰æ‹©æ–‡ä»¶ æˆ– å°†æ–‡ä»¶æ‹–æ‹½è‡³æ­¤å¤„</h3>
                    <p>æ”¯æŒæ ¼å¼: .docx, .pdf (æœ€å¤§é™åˆ¶ 50MB)</p>
                </div>
                <input type="file" name="file" id="file" required hidden accept=".docx,.pdf,.doc">
            </div>

            <div id="filePreview" class="file-preview">
                <i class="fas fa-file-alt"></i> <span id="fileName">æœªé€‰æ‹©æ–‡ä»¶</span>
            </div>

            <div class="action-area">
                <button type="submit" id="submitBtn" class="btn-submit" disabled>å¼€å§‹æ™ºèƒ½è¯„ä¼° <i class="fas fa-rocket"></i></button>
                <a href="{{ url_for('level3_view', level1_name=l1, level2_name=l2) }}" class="link-cancel">å–æ¶ˆå¹¶è¿”å›</a>
            </div>
        </form>

        <div id="processStatus" class="process-status">
            <div class="status-steps">
                <div class="step-item active" id="step1">
                    <div class="step-circle">1</div>
                    <div>æ–‡æ¡£ä¸Šä¼ </div>
                </div>
                <div class="step-item" id="step2">
                    <div class="step-circle">2</div>
                    <div>AI æ€è€ƒ</div>
                </div>
                <div class="step-item" id="step3">
                    <div class="step-circle">3</div>
                    <div>ç”ŸæˆæŠ¥å‘Š</div>
                </div>
            </div>
            
            <div style="display: flex; justify-content: space-between; margin-top: 10px; font-size: 13px; color: #666;">
                <span id="progressText">å‡†å¤‡å°±ç»ª</span>
                <span id="progressPercent">0%</span>
            </div>
            <div class="progress-track">
                <div class="progress-bar-fill" id="progressBar"></div>
            </div>
        </div>

        {% if error %}
        <div style="margin-top: 20px; background: #fee2e2; color: #991b1b; padding: 15px; border-radius: 8px; border: 1px solid #fecaca; text-align: left;">
            <i class="fas fa-exclamation-circle"></i> <strong>å¤„ç†å¤±è´¥ï¼š</strong> {{ error }}
        </div>
        {% endif %}
    </div>

    {% if result %}
        <div id="raw-result-data" style="display: none;">{{ result }}</div>
        <div id="rendered-result" class="result-container"></div>
    {% endif %}

</div>

<script>
    // === 1. æ‹–æ‹½ä¸æ–‡ä»¶é€‰æ‹©äº¤äº’ ===
    const dropZone = document.getElementById('dropZone');
    const fileInput = document.getElementById('file');
    const filePreview = document.getElementById('filePreview');
    const fileName = document.getElementById('fileName');
    const submitBtn = document.getElementById('submitBtn');

    // æ‹–æ‹½é«˜äº®
    ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
        dropZone.addEventListener(eventName, preventDefaults, false);
    });
    function preventDefaults(e) { e.preventDefault(); e.stopPropagation(); }
    
    ['dragenter', 'dragover'].forEach(eventName => {
        dropZone.addEventListener(eventName, () => dropZone.classList.add('dragover'), false);
    });
    ['dragleave', 'drop'].forEach(eventName => {
        dropZone.addEventListener(eventName, () => dropZone.classList.remove('dragover'), false);
    });

    // æ–‡ä»¶æ”¾ç½®
    dropZone.addEventListener('drop', (e) => {
        const dt = e.dataTransfer;
        const files = dt.files;
        handleFiles(files);
    });

    // ç‚¹å‡»é€‰æ‹©
    fileInput.addEventListener('change', function() {
        handleFiles(this.files);
    });

    function handleFiles(files) {
        if (files.length > 0) {
            fileInput.files = files; // é‡æ–°èµ‹å€¼ç»™ inputï¼Œç¡®ä¿æäº¤æ—¶æœ‰æ–‡ä»¶
            fileName.innerText = files[0].name;
            filePreview.style.display = 'flex';
            submitBtn.disabled = false;
        }
    }

    // === 2. è¿›åº¦æ¡åŠ¨ç”»æ¨¡æ‹Ÿ ===
    const form = document.getElementById('uploadForm');
    const processStatus = document.getElementById('processStatus');
    
    if(form) {
        form.addEventListener('submit', function(e) {
            if (!fileInput.value) return;
            
            // UI åˆ‡æ¢
            processStatus.style.display = 'block';
            submitBtn.style.display = 'none'; // éšè—æŒ‰é’®é˜²æ­¢é‡å¤æäº¤
            document.querySelector('.link-cancel').style.display = 'none'; // éšè—å–æ¶ˆæŒ‰é’®
            dropZone.style.display = 'none';  // éšè—ä¸Šä¼ æ¡†è®©ç•Œé¢æ›´æ¸…çˆ½

            let width = 0;
            const interval = setInterval(function() {
                // æ¨¡æ‹Ÿè¿›åº¦ï¼šå¿«-æ…¢-å¡ä½ç­‰å¾…åç«¯
                let increment = 1;
                if (width > 30) increment = 0.5;
                if (width > 80) increment = 0.05; // 80%åå˜å¾—éå¸¸æ…¢ï¼Œç­‰å¾…åç«¯è¿”å›
                
                if (width < 98) width += increment;
                
                document.getElementById('progressBar').style.width = width + '%';
                document.getElementById('progressPercent').innerText = Math.floor(width) + '%';
                
                // æ›´æ–°æ­¥éª¤çŠ¶æ€
                if (width > 30) {
                    document.getElementById('step2').classList.add('active');
                    document.getElementById('progressText').innerText = 'æ­£åœ¨è°ƒç”¨å…‰æ˜å¤§æ¨¡å‹è¿›è¡Œæ·±åº¦æ¨ç†...';
                }
                if (width > 90) {
                    document.getElementById('step3').classList.add('active');
                    document.getElementById('progressText').innerText = 'æ­£åœ¨ç”Ÿæˆç»“æ„åŒ–æŠ¥å‘Š...';
                }

            }, 50);
        });
    }

    // === 3. ç»“æœæ¸²æŸ“é€»è¾‘ (ä¿ç•™åŸæœ‰ä¼˜ç§€é€»è¾‘) ===
    document.addEventListener('DOMContentLoaded', function() {
        const rawDataDiv = document.getElementById('raw-result-data');
        if (!rawDataDiv) return;
        
        // æ—¢ç„¶å·²ç»æœ‰ç»“æœäº†ï¼Œéšè—ä¸Šä¼ åŒºï¼Œåªæ˜¾ç¤ºç»“æœ
        document.querySelector('.upload-card').style.display = 'none';

        const container = document.getElementById('rendered-result');
        let data = null;
        try { data = JSON.parse(rawDataDiv.innerText); } catch (e) { container.innerHTML = `<div class="result-card" style="padding:20px; color:red;">JSONè§£æå¤±è´¥</div>`; return; }

        if (data.error) { container.innerHTML = `<div class="result-card" style="padding:20px; color:red;">${data.error}</div>`; return; }

        let html = '<div class="result-card">';
        let score = 0; let isCompliant = false; let title = "è¯„ä¼°æŠ¥å‘Š"; let titleColor = "#333";

        // æ™ºèƒ½åˆ¤æ–­åˆ†æ•°ç±»å‹
        if (data.compliance_score !== undefined) {
            score = data.compliance_score; isCompliant = data.is_compliant;
            title = isCompliant ? "æ–¹æ¡ˆåˆè§„" : "å­˜åœ¨é£é™©";
            titleColor = isCompliant ? "#28a745" : "#dc3545";
        } else if (data.rationality_score !== undefined) {
            score = data.rationality_score;
            title = score >= 80 ? "é€»è¾‘åˆç†" : "é€»è¾‘å¼‚å¸¸";
            titleColor = score >= 80 ? "#28a745" : "#fd7e14";
        }

        // æ¸²æŸ“å¤´éƒ¨
        html += `
        <div class="result-header">
            <div>
                <div style="font-size:12px; color:#999; text-transform:uppercase; letter-spacing:1px;">EVALUATION REPORT</div>
                <h2 style="margin:5px 0; color:${titleColor};">${title}</h2>
                <span class="badge ${score>=80?'badge-blue':'badge-red'}">AI ç”Ÿæˆæ—¶é—´: ${new Date().toLocaleTimeString()}</span>
            </div>
            <div style="text-align:right;">
                <div class="score-val" style="color:${titleColor}">${score}</div>
                <div style="font-size:12px; color:#999;">ç»¼åˆè¯„åˆ†</div>
            </div>
        </div>
        <div class="result-body">`;

        // ä¸“å®¶ç‚¹è¯„åŒº
        if (data.details || data.expert_comment) {
            html += `<div style="background:#f8f9fa; padding:20px; border-radius:8px; border-left:4px solid var(--sgcc-dark); margin-bottom:25px;">
                <h4 style="margin-top:0;"><i class="fas fa-quote-left" style="color:#ddd; margin-right:10px;"></i>ä¸“å®¶ç»¼è¿°</h4>
                <p style="color:#555; line-height:1.6;">${data.details || data.expert_comment}</p>
            </div>`;
        }

        // åŠ¨æ€æ¸²æŸ“åˆ—è¡¨ (ç¼ºå¤±é¡¹)
        if (data.missing_items && data.missing_items.length > 0) {
            html += `<h3 style="border-bottom:2px solid #eee; padding-bottom:10px; margin-top:30px;">âŒ ç¼ºå¤±å†…å®¹æ¸…å•</h3><ul>`;
            data.missing_items.forEach(item => html += `<li style="margin-bottom:8px; color:#666;"><i class="fas fa-times-circle" style="color:#dc3545; margin-right:8px;"></i>${item}</li>`);
            html += `</ul>`;
        } else if (data.missing_items) {
            html += `<div style="color:#28a745; background:#f0fcf6; padding:15px; border-radius:6px; margin-top:20px;"><i class="fas fa-check-circle"></i> æ‰€æœ‰å®¡æŸ¥é¡¹å‡å·²å®Œå¤‡ã€‚</div>`;
        }

        // é€»è¾‘é”™è¯¯è¡¨æ ¼
        if (data.logic_errors && data.logic_errors.length > 0) {
            html += `<h3 style="border-bottom:2px solid #eee; padding-bottom:10px; margin-top:30px;">âš ï¸ é€»è¾‘çŸ›ç›¾ç‚¹</h3>
            <table class="sgcc-table"><thead><tr><th width="20%">ä½ç½®</th><th>é—®é¢˜æè¿°</th><th>ä¸¥é‡ç¨‹åº¦</th></tr></thead><tbody>`;
            data.logic_errors.forEach(err => html += `<tr><td>${err.location||'å…¨æ–‡'}</td><td>${err.issue}</td><td><span class="badge badge-red">${err.severity}</span></td></tr>`);
            html += `</tbody></table>`;
        }

        // ç¼ºé™·è¡¨æ ¼
        if (data.classified_issues && data.classified_issues.length > 0) {
            html += `<h3 style="border-bottom:2px solid #eee; padding-bottom:10px; margin-top:30px;">ğŸ“Š ç¼ºé™·è¯¦ç»†åˆ†å¸ƒ</h3>
            <div id="defectChart" style="width:100%; height:300px; margin-bottom:20px;"></div>
            <table class="sgcc-table"><thead><tr><th width="15%">ä½ç½®</th><th>é—®é¢˜</th><th>ç­‰çº§</th><th>å¯èƒ½åŸå› </th></tr></thead><tbody>`;
            data.classified_issues.forEach(issue => {
                let badgeClass = issue.level === 'ä¸¥é‡' ? 'badge-red' : (issue.level === 'ä¸€èˆ¬' ? 'badge-yellow' : 'badge-blue');
                html += `<tr><td>${issue.location||'-'}</td><td>${issue.issue}</td><td><span class="badge ${badgeClass}">${issue.level}</span></td><td>${issue.reason}</td></tr>`;
            });
            html += `</tbody></table>`;
        }

        // å›¾æ–‡ä¸€è‡´æ€§éƒ¨åˆ†
        if (data.conflicts && data.conflicts.length > 0) {
            html += `<h3 style="margin-top:30px; color:#d9534f;">âš ï¸ å¤šæ¨¡æ€ä¸€è‡´æ€§å†²çª</h3><table class="sgcc-table"><thead><tr><th>ä½ç½®</th><th>ç‰¹å¾å¯¹è±¡</th><th>æ­£æ–‡æè¿°</th><th>å›¾è¡¨æè¿°</th><th>ç»“è®º</th></tr></thead><tbody>`;
            data.conflicts.forEach(c => {
                 html += `<tr><td>${c.location||'-'}</td><td><b>${c.parameter}</b></td><td>${c.text_value}</td><td>${c.context_value}</td><td style="color:#dc3545">${c.conclusion}</td></tr>`;
            });
            html += `</tbody></table>`;
        }

        html += '</div></div>';
        
        // ã€æ ¸å¿ƒä¿®æ”¹ã€‘ç»“æœé¡µåº•éƒ¨çš„è¿”å›æŒ‰é’®åŒº
        html += `
        <div style="text-align:center; margin-top:40px; display:flex; gap:15px; justify-content:center;">
            <a href="{{ url_for('level3_view', level1_name=l1, level2_name=l2) }}" class="btn-back-header" style="padding:12px 30px;">
                <i class="fas fa-arrow-left"></i> è¿”å›åŠŸèƒ½åˆ—è¡¨
            </a>
            <a href="javascript:location.reload()" class="btn-submit" style="text-decoration:none;">
                <i class="fas fa-redo"></i> è¯„ä¼°ä¸‹ä¸€ä¸ªæ–‡æ¡£
            </a>
        </div>`;
        
        container.innerHTML = html;

        // å›¾è¡¨åˆå§‹åŒ–
        if (data.classified_issues && typeof echarts !== 'undefined') {
            let counts = { 'red': 0, 'yellow': 0, 'blue': 0 };
            data.classified_issues.forEach(i => { if (counts[i.level] !== undefined) counts[i.level]++; });
            var myChart = echarts.init(document.getElementById('defectChart'));
            myChart.setOption({
                tooltip: { trigger: 'item' },
                legend: { top: '5%', left: 'center' },
                color: ['#dc3545', '#fd7e14', '#17a2b8'],
                series: [{ type: 'pie', radius: ['40%', '70%'], avoidLabelOverlap: false, label: { show: false }, data: [{value:counts.red, name:'ä¸¥é‡'}, {value:counts.yellow, name:'ä¸€èˆ¬'}, {value:counts.blue, name:'å»ºè®®'}] }]
            });
        }
    });
</script>
{% endblock %}