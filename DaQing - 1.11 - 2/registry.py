class MenuRegistry:
    def __init__(self):
        # 初始化时，先填入原来的静态数据，保证旧功能可用
        self.menu_data = {
            "方案编制生成": {
                "方案汇集": ["历史资料导入", "资料文件格式标准化", "多源信息整合视图构建", "评审知识内容管理"],
                "规划方案资料质量提升": ["规划方案数据去噪", "异构数据格式统一转换", "规划要素智能标签", "数据标签质量校验"],
                "模型性能分析": ["模型参数一致性检查", "模型仿真结果对比", "极端场景鲁棒性计算", "精度与误差评估"],
                "光明大模型部署": ["部署环境初始化", "数据导入", "光明大模型部署测试", "光明大模型部署评估"],
                "光明大模型性能验证": ["验证集评估", "指标达标性验证", "模型泛化能力测试", "验证过程回溯分析"],
                "光明大模型增强数据优化": ["增强方式选择", "增强数据筛选与清洗", "原始数据输入格式转换", "输入特征归一化"],
                "光明大模型增强": ["领域知识整合", "模型增强参数调整", "增强过程优化", "模型生成内容优化"],
                "智能方案文本生成": ["用户需求语义分析", "定制化方案文本生成", "用户反馈与方案评价分析", "个性化方案内容调整"]
            },
            "动态数据同步": {
                "动态数据规范与管理": ["数据标准化管理", "数据质量保障", "数据访问安全与隐私保护", "数据全生命周期管理"],
                "数据源连接与监控": ["配网规划数据源识别", "数据源状态监控", "数据源接口配置", "数据源接入"],
                "数据获取与整合": ["数据源主动推送", "缓冲数据自动获取", "目标数据格式转换", "多源数据智能融合"],
                "实时数据处理": ["实时数据流接收", "流数据解析与结构化", "高频动态数据缓存", "动态数据异常识别"],
                "动态数据质量检测": ["完整性校验", "一致性校验", "逻辑关系校验", "异常值检测"],
                "数据同步与更新": ["数据变化实时捕获", "变化数据高速传输", "数据更新冲突检测", "光明大模型数据一致性更新"]
            },
            "全流程闭环": {
                "智能负荷预测": ["异构数据处理与编码", "小样本增强", "动态特征选择", "模型推理与标准化输出"],
                "负荷预测结果验证": ["当前负荷结果历史对比", "多模型预测输出一致性检验", "预测误差范围分析", "极端边界条件预测验证"],
                "智能设备选型": ["设备知识向量库构建", "两阶段设备智能筛选", "设备规格与兼容性生成", "设备选型验证与交互优化"],
                "设备选型符合性验证": ["设备规格匹配度校验", "设备系统与拓扑兼容性测试", "设备性能指标符合性验证", "设备环境适应性与可靠性评估"],
                "智能保护定值计算": ["保护定值数据解析与标准化", "可执行保护定值规则生成", "保护定值动态参数调整", "大规模电网高性能并行计算"],
                "保护定值结果验证": ["保护定值规则准确性与完整性校验", "定值计算结果理论与历史比对", "不同运行状态动态响应测试", "异常定值智能检测与修正"],
                "智能草图输出": ["草图输入智能解析与分类", "多层次设计细节注释生成", "光明大模型视觉生成与一致性验证", "多格式草图导出与标准嵌入"],
                "草图输出质量验证": ["输出草图完整性检查", "草图格式与软件兼容性验证", "草图视觉质量与细节评估", "草图设计版本一致性核对"]
            },
            "知识库建设管理": {
                "知识采集": ["多源知识接入与清洗", "非结构化文档知识智能抽取", "知识可信度与相关性过滤", "知识新鲜度智能标记与更新提示"],
                "知识体系构建": ["知识内容智能分类", "关键知识点摘要生成", "知识关联关系智能分析与网络构建", "知识内容定期审核与更新"],
                "知识智能应用": ["智能检索与语义联想", "决策路径知识追溯展示", "知识主动推送与智能推荐", "知识应用效果分析"],
                "知识应用效果评估": ["知识利用率分析", "知识应用业务效果监测", "用户满意度调查", "知识库优化与更新建议生成"],
                "知识库维护": ["低效/冲突知识自动巡检", "知识条目版本控制与回滚", "知识冲突智能检测", "低价值知识智能归档"],
                "知识库更新": ["最新行业标准与政策资料采集", "新增知识准确性与相关性审核", "知识条目版本迭代与变更管理", "更新知识跨系统同步分发"]
            },
            "质量评测": {
                # 注意：这里保留旧的静态数据。
                # 当 module_5_1 运行时，它会覆盖掉这里的 "智能自动评估" 这一项，
                # 但会保留 "人工复核工作" 等其他兄弟项。
                "智能自动评估": ["评审规则引擎自动检测", "光明大模型内容合理性智能评分", "缺陷分级智能标注与提示", "多模态特征融合一致性校验"],
                "人工复核工作": ["复核任务智能分配", "人工问题确认与证据上传", "复核反馈意见收集与知识库同步", "复核进度与效率监控"],
                "复核结果分析": ["复核过程数据自动汇总", "复核结果异常与不一致项识别", "复核结果准确性与完整性评估", "复核流程改进建议生成"],
                "评测报告智能生成": ["差异化评测报告模板配置", "缺陷问题高频可视化分析", "相似案例评审结论对比", "报告关键摘要智能生成"],
                "生成报告质量验证": ["报告内容数据与结论核对", "报告格式规范符合性检查", "报告关键性能指标准确性验证", "报告用户反馈收集与改进"]
            },
            "建议生成": {
                "问题智能匹配": ["缺陷类型智能识别与分类", "解决方案与政策依据智能匹配", "建议优先级智能判断", "缺陷根因分析与深度支持"],
                "智能策略生成": ["标准化整改步骤建议生成", "个性化方案推荐", "成本效益优化建议生成", "风险预防与应急策略生成"],
                "策略效果评估": ["策略实际应用效果评估", "策略实施风险识别与分析", "策略相关关键性能指标监测", "策略调整与优化建议生成"],
                "智能反馈学习": ["失效建议原因智能分析", "优质人工修正建议自动化沉淀", "建议采纳率跟踪与影响因素分析", "模型增强框架优化"]
            }
        }

    def register(self, level1, level2, features):
        """
        模块调用此方法注册自己的菜单信息
        """
        # 1. 如果一级菜单不存在，创建它
        if level1 not in self.menu_data:
            self.menu_data[level1] = {}
        
        # 2. 注册/覆盖特定的二级菜单
        # 这样，module_5_1 只会更新 "质量评测" -> "智能自动评估" 这一小块，
        # 而不会弄丢 "质量评测" 下的其他数据（如 "人工复核工作"）。
        self.menu_data[level1][level2] = features

# 创建全局单例对象
menu_registry = MenuRegistry()